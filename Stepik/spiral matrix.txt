Задачка по заполнению произвольной матрицы спиралью

Когда-нибудь я вернусь сюда и перепишу это по человечески, а пока пусть полежит